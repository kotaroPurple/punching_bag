# 心拍波形に摂動がある場合の解析

## 摂動を含む心拍波形のモデル化

実際の心拍による胸壁の動きは、単純な正弦波ではなく、心臓の収縮期と拡張期に対応した複雑な波形を示す。特に収縮期（心室収縮）において、周期の1/4付近に小さな盛り上がりが観察されることがある。このような波形を数学的にモデル化するために、基本的な正弦波に摂動項を加えた以下のような変位モデルを考える：

$$d(t) = d_0 \sin(\omega t) + d_p \sin(n\omega t + \phi)$$

ここで：
- $d_0$：基本的な心拍による変位振幅
- $\omega$：心拍の基本角周波数
- $d_p$：摂動の振幅（$d_p \ll d_0$）
- $n$：摂動の周波数倍率（$n > 1$、整数）
- $\phi$：摂動の位相シフト

周期の1/4付近に盛り上がりを生じさせるためには、$n = 4$ とし、$\phi$ を適切に調整する（例：$\phi = -\pi/2$）。

## 摂動を含む変位に対するIQ波形

摂動を含む変位に対するIQ波形は次のように表される：

$$s(t) = \exp(2ki \cdot d(t)) = \exp(2ki \cdot [d_0 \sin(\omega t) + d_p \sin(n\omega t + \phi)])$$

この式は直接ベッセル関数で展開することが難しいため、以下のように分解して考える：

$$s(t) = \exp(2ki \cdot d_0 \sin(\omega t)) \cdot \exp(2ki \cdot d_p \sin(n\omega t + \phi))$$

それぞれの項をベッセル関数で展開すると：

$$\exp(2ki \cdot d_0 \sin(\omega t)) = \sum_{m=-\infty}^{\infty} J_m(2kd_0) \exp(im\omega t)$$

$$\exp(2ki \cdot d_p \sin(n\omega t + \phi)) = \sum_{l=-\infty}^{\infty} J_l(2kd_p) \exp(il(n\omega t + \phi))$$

これらの積は畳み込みになる：

$$s(t) = \sum_{m=-\infty}^{\infty} \sum_{l=-\infty}^{\infty} J_m(2kd_0) J_l(2kd_p) e^{il\phi} \exp(i(m\omega + ln\omega)t)$$

## 振幅の大きさの影響

$d_p \ll d_0$（摂動の振幅は基本振幅よりはるかに小さい）という条件から、以下の近似が可能である：

1. $2kd_p$ は非常に小さい値となり、$J_0(2kd_p) \approx 1$、$J_{\pm 1}(2kd_p) \approx \pm kd_p$、$J_l(2kd_p) \approx 0$ ($|l| \geq 2$)

この条件下では、IQ波形は主に以下の項で近似できる：

$$s(t) \approx \sum_{m=-\infty}^{\infty} J_m(2kd_0) \exp(im\omega t) + \sum_{m=-\infty}^{\infty} J_m(2kd_0) \cdot kd_p e^{i\phi} \exp(i(m+n)\omega t) - \sum_{m=-\infty}^{\infty} J_m(2kd_0) \cdot kd_p e^{-i\phi} \exp(i(m-n)\omega t)$$

## 強度変化の解析

IQ波形の強度 $|s(t)|^2$ を考えると、以下の周波数成分が現れる：

1. **基本心拍成分**: $\omega$ とその倍音
2. **摂動による成分**: $n\omega$ とその倍音
3. **相互変調成分**: $m\omega \pm ln\omega$（$m$, $l$は整数）

特に重要な相互変調成分は：
- $(n-1)\omega$（例：$n=4$ の場合、$3\omega$）
- $(n+1)\omega$（例：$n=4$ の場合、$5\omega$）

## 摂動の影響による周波数スペクトルの変化

摂動がない場合、強度変化のスペクトルは主に $2\omega$ にピークを持つ。摂動がある場合、以下の変化が生じる：

1. **新たな周波数成分の出現**:
   - $2n\omega$（例：$n=4$ の場合、$8\omega$）
   - $(n \pm 1)\omega$（例：$n=4$ の場合、$3\omega$ と $5\omega$）
   - $(n \pm 2)\omega$（例：$n=4$ の場合、$2\omega$ と $6\omega$）

2. **基本周波数成分の変調**:
   - $2\omega$ 成分の振幅が変化
   - 位相関係も変化

3. **高調波構造の複雑化**:
   - 単純な倍音構造から、より複雑な周波数関係へ

## 心拍数推定への影響

摂動がある場合の心拍数推定への影響は以下の通り：

1. **スペクトルの複雑化**:
   - 単一のピークではなく、複数のピークが現れる
   - 最大ピークが必ずしも $2\omega$ に対応しない可能性

2. **推定精度への影響**:
   - 摂動が小さい場合（$d_p \ll d_0$）、影響は限定的
   - 摂動が大きい場合、誤った周波数を検出する可能性

3. **対策**:
   - 複数のピークを検出し、その関係から基本周波数を推定
   - 時間-周波数解析を用いて、一時的な摂動の影響を軽減

## 簡略化した計算のための近似

摂動が小さい場合（$d_p \ll d_0$）、強度変化は以下のように近似できる：

$$\|s(t)\|^2 \approx 1 - J_0^2(2kd_0) - 4J_0(2kd_0) \sum_{m=1}^{\infty} J_{2m}(2kd_0) \cos(2m\omega t) + 2kd_p \sum_{m=-\infty}^{\infty} \sum_{l=-\infty}^{\infty} J_m(2kd_0) J_l(2kd_0) \sin((m-l+n)\omega t + \phi)$$

この式の第3項が摂動による影響を表し、$(m-l+n)\omega$ の周波数成分を生成する。